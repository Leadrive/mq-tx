## 基于RabbiMQ的分布式事务Demo

一个简单的基于rabbitMQ的分布式事务demo程序

### 原理

基于rabbitmq的分布式事务的主要解决以下两个问题：

1、如何保证消息100%被送到rabbitMq

利用rabbitMq的确认机制，当生产者发送消息后，会回传一个ack确认，没有收到该消息，则进行消息重传；

2、如何保证消费者100%的接收到消息并消费

利用手动消息确认，可以保证事务一定会被接受消息并消费，对于没有消费成功的事务，可以选择重传或者其它逻辑处理；消费端利用redis进行幂等处理，保证同一条消息只被处理一次

<img src="./mq.png" alt="mq" style="zoom: 67%;" />

### 后期计划

该demo只是第一版本，后续添加：

1、接收端的消息推送确认机制是同步，应该做成异步确认提高性能

2、rabbitMq挂掉后的重连机制

3、设计合理的消息重传机制

4、添加事务补偿机制